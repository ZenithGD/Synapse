TODO: Improve class hierarchy and add base class